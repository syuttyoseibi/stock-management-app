æ‰¿çŸ¥ã„ãŸã—ã¾ã—ãŸã€‚Gemini CLIã®ç’°å¢ƒã§ãƒ†ã‚¹ãƒˆã™ã‚‹ãŸã‚ã€æ‰‹é †æ›¸ã®å†…å®¹ã‚’ç›´æ¥ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«è²¼ã‚Šä»˜ã‘ã‚„ã™ã„ã‚ˆã†ã«ã€ç´”ç²‹ãª**Markdownå½¢å¼ã®ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**ã¨ã—ã¦å†…å®¹ã‚’å†æ§‹æˆã—ã€ãã®å‡ºåŠ›ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ­ãƒ¼ã‚«ãƒ«PCã«ä¿å­˜ã—ã¦ã€Notionã«ã‚³ãƒ”ãƒšã—ãŸã‚Šã€CLIã«ç›´æ¥è²¼ã‚Šä»˜ã‘ãŸã‚Šã—ã¦æ´»ç”¨ã—ã¦ãã ã•ã„ã€‚

-----

## å§”è¨—åœ¨åº«ç®¡ç†ãƒ„ãƒ¼ãƒ«æ§‹ç¯‰æ‰‹é †æ›¸ï¼ˆRaspberry Pi 4ç‰ˆï¼‰ãƒ†ã‚­ã‚¹ãƒˆå‡ºåŠ›

````markdown
# å§”è¨—åœ¨åº«ç®¡ç†ãƒ„ãƒ¼ãƒ«æ§‹ç¯‰æ‰‹é †æ›¸ï¼ˆRaspberry Pi 4ç‰ˆï¼‰

## ğŸ¯ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

è¶…ä½ã‚³ã‚¹ãƒˆã§24æ™‚é–“ç¨¼åƒå¯èƒ½ãªãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åœ¨åº«ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã™ã‚‹ã€‚

---

## ğŸ›  ãƒ•ã‚§ãƒ¼ã‚º 1: é–‹ç™ºç’°å¢ƒï¼ˆãƒ­ãƒ¼ã‚«ãƒ«PCï¼‰ã®æº–å‚™

1. **ãƒ„ãƒ¼ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«:** Git, Node.js, Docker Desktopã‚’ãƒ­ãƒ¼ã‚«ãƒ«PCã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚
2. **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚©ãƒ«ãƒ€ã®ä½œæˆ:**
    ```bash
    mkdir stock-management-app
    cd stock-management-app
    git init
    ```

---

## ğŸ’» ãƒ•ã‚§ãƒ¼ã‚º 2: ã‚µãƒ¼ãƒãƒ¼ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ä½œæˆ

### ã‚¹ãƒ†ãƒƒãƒ— 2-1: ä¾å­˜é–¢ä¿‚ã®å®šç¾© (`package.json`)

```json
{
  "name": "stock-management-app",
  "version": "1.0.0",
  "description": "Consignment Stock Management Tool for Auto Repair",
  "main": "server.js",
  "scripts": {
    "start": "node server.js"
  },
  "dependencies": {
    "express": "^4.18.2",
    "sqlite3": "^5.1.7"
  }
}
````

### ã‚¹ãƒ†ãƒƒãƒ— 2-2: Dockerç’°å¢ƒã®å®šç¾© (`Dockerfile`)

```dockerfile
FROM node:lts-alpine
WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .
CMD ["node", "server.js"]
```

### ã‚¹ãƒ†ãƒƒãƒ— 2-3: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã®æº–å‚™

`public`ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã—ã€ãã®ä¸­ã«`index.html`ã‚’ä½œæˆã—ã¾ã™ã€‚

**ãƒ•ã‚¡ã‚¤ãƒ«å: `public/index.html`**
*(æ³¨: é•·ã„JavaScriptã‚³ãƒ¼ãƒ‰ã‚’å«ã‚€ãŸã‚ã€Notionãªã©ã§ä¿å­˜ã™ã‚‹éš›ã¯ã€ã“ã®ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯å†…ã®å…¨ã¦ã‚’ä¸€ã¤ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã—ã¦ãã ã•ã„ã€‚)*

```html
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å§”è¨—åœ¨åº« ä½¿ç”¨è¨˜éŒ²</title>
    <style>
        body { font-family: sans-serif; padding: 20px; background-color: #f4f4f4; }
        .part-item { background: white; padding: 15px; margin-bottom: 10px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); display: flex; justify-content: space-between; align-items: center; }
        button { padding: 10px 15px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; }
        button:active { background-color: #0056b3; }
        #status { margin-top: 20px; padding: 10px; background-color: #e0f7e0; border-radius: 5px; text-align: center; }
    </style>
</head>
<body>
    <h1>åœ¨åº«ä½¿ç”¨è¨˜éŒ² - [å·¥å ´å]</h1>
    <input type="text" id="mechanic_name" placeholder="æ•´å‚™å£«åï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰" style="width: 100%; padding: 10px; margin-bottom: 20px; border: 1px solid #ccc; border-radius: 5px;">
    <div id="part-list"></div>
    <div id="status">éƒ¨å“ã‚’é¸æŠã—ã¦ãã ã•ã„</div>

    <script>
        document.addEventListener('DOMContentLoaded', loadParts);
        const partListDiv = document.getElementById('part-list');
        const statusDiv = document.getElementById('status');
        const mechanicInput = document.getElementById('mechanic_name');

        async function loadParts() {
            const response = await fetch('/api/parts');
            const parts = await response.json();
            partListDiv.innerHTML = ''; 

            parts.forEach(part => {
                const item = document.createElement('div');
                item.className = 'part-item';
                
                const info = document.createElement('span');
                info.textContent = `${part.part_name} (åœ¨åº«: ${part.current_stock})`;
                item.appendChild(info);

                const button = document.createElement('button');
                button.textContent = 'ä½¿ç”¨';
                button.onclick = () => usePart(part.id, part.part_name);
                item.appendChild(button);
                
                partListDiv.appendChild(item);
            });
        }

        async function usePart(partId, partName) {
            const mechanic_name = mechanicInput.value;
            statusDiv.textContent = `${partName} ã‚’è¨˜éŒ²ä¸­...`;

            try {
                const response = await fetch('/api/use-part', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ part_id: partId, mechanic_name: mechanic_name })
                });
                const result = await response.json();
                
                if (response.ok) {
                    statusDiv.style.backgroundColor = '#e0f7e0';
                    statusDiv.textContent = `âœ… ${partName} ã®ä½¿ç”¨ã‚’è¨˜éŒ²ã—ã¾ã—ãŸã€‚æ®‹ã‚Šåœ¨åº«: ${result.stock_left}`;
                    loadParts(); 
                } else {
                    statusDiv.style.backgroundColor = '#f7e0e0';
                    statusDiv.textContent = `âŒ ã‚¨ãƒ©ãƒ¼: ${result.error || 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼'}`;
                }
            } catch (error) {
                statusDiv.style.backgroundColor = '#f7e0e0';
                statusDiv.textContent = `é€šä¿¡ã‚¨ãƒ©ãƒ¼: ã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šã§ãã¾ã›ã‚“ã€‚`;
            }
        }
    </script>
</body>
</html>
```

### ã‚¹ãƒ†ãƒƒãƒ— 2-4: ã‚µãƒ¼ãƒãƒ¼ãƒ­ã‚¸ãƒƒã‚¯ (`server.js`)

```javascript
const express = require('express');
const sqlite3 = require('sqlite3').verbose();
const db = new sqlite3.Database('./stock.db');
const app = express();
const PORT = 3000;

app.use(express.json());
app.use(express.static('public')); 

// --- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨åˆæœŸãƒ‡ãƒ¼ã‚¿ã®æº–å‚™ ---
db.serialize(() => {
    db.run(`CREATE TABLE IF NOT EXISTS parts (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        part_name TEXT NOT NULL,
        stock_location TEXT NOT NULL,
        current_stock INTEGER NOT NULL,
        min_reorder_level INTEGER NOT NULL
    )`);

    db.run(`CREATE TABLE IF NOT EXISTS usage_history (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        part_id INTEGER NOT NULL,
        usage_time TEXT NOT NULL,
        mechanic_name TEXT,
        FOREIGN KEY (part_id) REFERENCES parts(id)
    )`);
    
    db.get("SELECT COUNT(*) AS count FROM parts", (err, row) => {
        if (row && row.count === 0) {
            const stmt = db.prepare("INSERT INTO parts (part_name, stock_location, current_stock, min_reorder_level) VALUES (?, ?, ?, ?)");
            stmt.run("ã‚ªã‚¤ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ X10", "ç”°è¾ºå·¥å ´_æ£šA", 15, 5);
            stmt.run("ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ‘ãƒƒãƒ‰ R20", "ç”°è¾ºå·¥å ´_æ£šB", 8, 3);
            stmt.run("ãƒãƒƒãƒ†ãƒªãƒ¼ V60", "ç”°è¾ºå·¥å ´_æ£šC", 4, 2);
            stmt.finalize();
            console.log("Initial test data inserted.");
        }
    });
});


// API 1: éƒ¨å“ãƒªã‚¹ãƒˆã®å–å¾—
app.get('/api/parts', (req, res) => {
    db.all("SELECT id, part_name, current_stock FROM parts ORDER BY part_name", [], (err, rows) => {
        if (err) return res.status(500).json({ error: err.message });
        res.json(rows);
    });
});

// API 2: éƒ¨å“ã®ä½¿ç”¨è¨˜éŒ²
app.post('/api/use-part', (req, res) => {
    const { part_id, mechanic_name } = req.body;
    if (!part_id) return res.status(400).json({ error: "éƒ¨å“IDãŒå¿…è¦ã§ã™" });

    db.serialize(() => {
        db.run("BEGIN TRANSACTION;");

        db.run("UPDATE parts SET current_stock = current_stock - 1 WHERE id = ? AND current_stock > 0", [part_id], function(err) {
            if (err || this.changes === 0) { 
                db.run("ROLLBACK;");
                return res.status(400).json({ error: "åœ¨åº«ãŒãªã„ã‹ã€åœ¨åº«æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸã€‚" });
            }

            db.run("INSERT INTO usage_history (part_id, usage_time, mechanic_name) VALUES (?, datetime('now', 'localtime'), ?)", [part_id, mechanic_name || 'ä¸æ˜'], function(err) {
                if (err) {
                    db.run("ROLLBACK;");
                    return res.status(500).json({ error: "å±¥æ­´è¨˜éŒ²ã‚¨ãƒ©ãƒ¼: " + err.message });
                }

                db.get("SELECT part_name, current_stock, min_reorder_level FROM parts WHERE id = ?", [part_id], (err, row) => {
                    if (row && row.current_stock < row.min_reorder_level) {
                        console.log(`!!! å†ç™ºæ³¨ã‚¢ãƒ©ãƒ¼ãƒˆ: ${row.part_name} ãŒæœ€ä½ç™ºæ³¨ãƒ¬ãƒ™ãƒ« (${row.min_reorder_level})ã‚’ä¸‹å›ã‚Šã¾ã—ãŸã€‚ç¾åœ¨ã®åœ¨åº«: ${row.current_stock}`);
                    }
                    db.run("COMMIT;");
                    res.json({ message: "ä½¿ç”¨è¨˜éŒ²ãŒå®Œäº†ã—ã¾ã—ãŸã€‚", stock_left: row.current_stock });
                });
            });
        });
    });
});

app.listen(PORT, () => console.log(`Server running on http://localhost:${PORT}`));
```

-----

## ğŸ›  ãƒ•ã‚§ãƒ¼ã‚º 3: ãƒ©ã‚ºãƒ‘ã‚¤ï¼ˆã‚µãƒ¼ãƒãƒ¼ï¼‰ã®æº–å‚™ (ç¶šã)

*(ã“ã®ãƒ•ã‚§ãƒ¼ã‚ºã¯ã€ãƒ©ã‚ºãƒ‘ã‚¤ä¸Šã§æ‰‹å‹•ã§å®Ÿè¡ŒãŒå¿…è¦ã§ã™ã€‚)*

1.  **SSHæ¥ç¶š:** `ssh [ãƒ¦ãƒ¼ã‚¶ãƒ¼å]@[ãƒ©ã‚ºãƒ‘ã‚¤ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹]`
2.  **Dockerã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«:**
    ```bash
    curl -sSL [https://get.docker.com](https://get.docker.com) | sh
    sudo usermod -aG docker pi
    # å†æ¥ç¶š
    ```

-----

## ğŸš€ ãƒ•ã‚§ãƒ¼ã‚º 4: ãƒ‡ãƒ—ãƒ­ã‚¤ã¨ãƒ†ã‚¹ãƒˆ (ç¶šã)

*(ã“ã®ãƒ•ã‚§ãƒ¼ã‚ºã¯ã€ãƒ­ãƒ¼ã‚«ãƒ«PCã¨ãƒ©ã‚ºãƒ‘ã‚¤ã®ä¸¡æ–¹ã§å®Ÿè¡ŒãŒå¿…è¦ã§ã™ã€‚)*

1.  **ã‚³ãƒ¼ãƒ‰è»¢é€ï¼ˆãƒ©ã‚ºãƒ‘ã‚¤å´ï¼‰:** `git clone`ã§ã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã—ã€`cd stock-management-app`
2.  **Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰ï¼ˆãƒ©ã‚ºãƒ‘ã‚¤å´ï¼‰:**
    ```bash
    docker build -t local-stock-app .
    ```
3.  **ã‚³ãƒ³ãƒ†ãƒŠã®èµ·å‹•ï¼ˆãƒ©ã‚ºãƒ‘ã‚¤å´ï¼‰:**
    ```bash
    docker run -d \
      -p 3000:3000 \
      --name stock-manager \
      --restart always \
      local-stock-app
    ```
4.  **å‹•ä½œç¢ºèª:** ãƒ–ãƒ©ã‚¦ã‚¶ã§ `http://[ãƒ©ã‚ºãƒ‘ã‚¤ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹]:3000` ã«ã‚¢ã‚¯ã‚»ã‚¹ã€‚

-----

## ğŸ”’ ãƒ•ã‚§ãƒ¼ã‚º 5: å¤–éƒ¨å…¬é–‹ã®ãƒ†ã‚¹ãƒˆï¼ˆNgrokåˆ©ç”¨ï¼‰

*(ã“ã®ãƒ•ã‚§ãƒ¼ã‚ºã¯ã€ãƒ©ã‚ºãƒ‘ã‚¤ä¸Šã§æ‰‹å‹•ã§å®Ÿè¡ŒãŒå¿…è¦ã§ã™ã€‚)*

1.  **Ngrokã®å®Ÿè¡Œï¼ˆãƒ©ã‚ºãƒ‘ã‚¤å´ï¼‰:**
    ```bash
    ngrok http 3000
    ```
2.  **å¤–éƒ¨ã‚¢ã‚¯ã‚»ã‚¹:** NgrokãŒè¡¨ç¤ºã—ãŸURLã‚’ãƒ¢ãƒã‚¤ãƒ«å›ç·šã§ç¢ºèªã€‚

<!-- end list -->

```
```