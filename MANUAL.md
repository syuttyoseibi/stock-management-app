## 在庫管理アプリケーション「ZAIKO」概要・手順書

### 1. アプリケーション概要

このアプリケーションは、自動車整備工場とその部品を供給する部品商のための、Webベースの在庫管理システムです。通称「ZAIKO」として開発されました。

主な目的は、整備工場における部品の在庫管理、使用履歴の追跡、発注業務の効率化です。また、部品商は自身が供給する店舗の在庫状況をリアルタイムで確認し、補充や部品マスタの管理を行えます。

システムは以下の3つの役割（ロール）を持つユーザーによって利用されます。

*   **整備工場 (Shop):** 日々の業務で部品を使用し、在庫を管理するユーザー。
*   **部品商 (Supplier):** 整備工場に部品を供給し、自身の部品マスタや担当従業員を管理するユーザー。
*   **システム管理者 (Admin):** 部品商や整備工場のアカウント発行など、システム全体を管理する最高権限を持つユーザー。

### 2. プロジェクト構造とデプロイ

このプロジェクトは、クラウドプラットフォーム **Render** 上で動作するように構成されています。

*   **バックエンド (`server.js`):**
    *   Node.js と Express フレームワークで構築されています。
    *   ユーザー認証、在庫操作、履歴記録など、すべてのAPIリクエストを処理します。
*   **フロントエンド (`public/`):**
    *   シンプルなHTML, CSS, JavaScriptで構成されています。
    *   `login.html`でログイン後、ユーザーの役割に応じて`index.html`（整備工場）または`admin.html`（部品商・管理者）にリダイレクトされます。
*   **データベース:**
    *   クラウド上のSupabase (PostgreSQL) を使用しており、データは永続的に保存されます。
*   **デプロイ (`render.yaml`):**
    *   アプリケーションのビルド方法や起動コマンドは `render.yaml` に定義されています。
    *   GitHubリポジトリへのプッシュをトリガーに、Renderが自動的にデプロイを実行します。

### 3. 使用手順書

#### 3.1. ログイン

1.  Webブラウザで `https://zaiko-app.onrender.com` のようなRenderから提供されたURLにアクセスすると、ログインページが表示されます。
2.  役割に応じたユーザー名とパスワードを入力してログインします。
    *   **整備工場ユーザーの場合:** `index.html` に移動します。
    *   **部品商・管理者ユーザーの場合:** `admin.html` に移動します。

#### 3.2. 整備工場の操作 (`index.html`)

主な利用者である整備工場の方向けの画面です。

*   **在庫一覧の確認:**
    *   現在の在庫部品、数量、保管場所などが一覧で表示されます。
*   **部品の使用記録:**
    *   作業で使用した部品の「使用」ボタンを押し、担当した従業員を選択することで、使用履歴を記録できます。
    *   在庫数が自動的に1つ減算されます。
    *   在庫が最低発注レベルを下回ると、サーバーのコンソールにアラートが表示されます。
*   **使用履歴の確認:**
    *   月や期間を指定して、部品の使用履歴を検索・確認できます。
    *   CSV形式で履歴をダウンロードすることも可能です。
*   **使用記録のキャンセル:**
    *   間違えて登録した使用記録を、理由を添えてキャンセル（取り消し）できます。
    *   キャンセルすると、部品の在庫数が1つ戻ります。
*   **従業員管理:**
    *   自社（工場）の従業員を追加・編集できます。部品使用記録の際に、ここで登録した従業員を選択します。

#### 3.3. 部品商・管理者の操作 (`admin.html`)

部品商と管理者が使用する多機能な管理ダッシュボードです。表示されるメニューは役割（部品商/管理者）によって一部異なります。

*   **在庫関連（共通）:**
    *   **全在庫の確認:** 管理下にあるすべての整備工場の在庫状況を一覧で確認できます。
    *   **在庫補充:** 工場の在庫を選択し、補充した数量を入力することで、在庫数を更新し、補充履歴を記録できます。
    *   **発注リスト:** 在庫数が最低発注レベルを下回っている部品を一覧で確認・CSV出力でき、発注業務に役立てられます。
*   **マスターデータ管理（共通）:**
    *   **部品管理:** 部品マスター（品番、品名）の登録、編集、削除ができます。CSVでの一括インポートも可能です。
    *   **カテゴリ管理:** 部品のカテゴリ（例: エンジン消耗品）を管理します。
*   **ユーザー・組織管理:**
    *   **従業員管理 (部品商):** 自社の従業員（補充担当者など）を管理します。
    *   **店舗管理 (共通):**
        *   **部品商:** 自身が担当する整備工場のアカウント（ログイン情報含む）を管理します。
        *   **管理者:** システムに登録されているすべての整備工場のアカウントを管理します。
    *   **部品商管理 (管理者のみ):** システムに登録する部品商のアカウント（ログイン情報含む）を管理します。
*   **履歴確認（共通）:**
    *   **全使用履歴:** 全店舗の部品使用履歴を横断的に検索・確認・CSV出力できます。
    *   **全補充履歴:** 全店舗の在庫補充履歴を検索・確認・CSV出力できます。
